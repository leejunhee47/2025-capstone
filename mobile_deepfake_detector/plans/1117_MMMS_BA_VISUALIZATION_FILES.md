# MMMS-BA Temporal Visualization - File Tree

## ğŸ“ ì „ì²´ ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
E:/capstone/
â”œâ”€â”€ mobile_deepfake_detector/
â”‚   â”œâ”€â”€ ğŸ“Š ì‹œê°í™” ìŠ¤í¬ë¦½íŠ¸ (ë©”ì¸)
â”‚   â”‚   â”œâ”€â”€ visualize_temporal_prediction.py          # ë‹¨ì¼ ìƒ˜í”Œ ì‹œê°í™”
â”‚   â”‚   â””â”€â”€ batch_visualize_temporal.py               # ë°°ì¹˜ ì‹œê°í™” (5ê°œ ìƒ˜í”Œ)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ¯ ëª¨ë¸ ë° ì²´í¬í¬ì¸íŠ¸
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â””â”€â”€ models/
â”‚   â”‚   â”‚       â””â”€â”€ teacher.py                        # MMMSBA ëª¨ë¸ ì •ì˜
â”‚   â”‚   â””â”€â”€ models/
â”‚   â”‚       â”œâ”€â”€ kfold/
â”‚   â”‚       â”‚   â”œâ”€â”€ fold_1/
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ mmms-ba_best.pth              # Baseline (Val Acc: 94.57%, REAL P(Fake): 58%)
â”‚   â”‚       â”‚   â”œâ”€â”€ fold_2/
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ mmms-ba_balanced_best.pth
â”‚   â”‚       â”‚   â”œâ”€â”€ fold_3/
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ mmms-ba_balanced_best.pth
â”‚   â”‚       â”‚   â”œâ”€â”€ fold_4/
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ mmms-ba_balanced_best.pth     # â­ BEST (Val Acc: 99.45%, REAL P(Fake): 73-77%)
â”‚   â”‚       â”‚   â”œâ”€â”€ fold_5/
â”‚   â”‚       â”‚   â”‚   â””â”€â”€ mmms-ba_balanced_best.pth
â”‚   â”‚       â”‚   â””â”€â”€ kfold_results.json                # 5-Fold í‰ê·  ê²°ê³¼
â”‚   â”‚       â””â”€â”€ checkpoints/
â”‚   â”‚           â””â”€â”€ mmms-ba_best.pth                  # ì´ˆê¸° í•™ìŠµ ëª¨ë¸
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ”§ ìœ í‹¸ë¦¬í‹°
â”‚   â”‚   â””â”€â”€ src/
â”‚   â”‚       â””â”€â”€ utils/
â”‚   â”‚           â””â”€â”€ mmms_ba_adapter.py                # NPZ â†’ Full frames ë¡œë”
â”‚   â”‚
â”‚   â”œâ”€â”€ âš™ï¸ ì„¤ì • íŒŒì¼
â”‚   â”‚   â””â”€â”€ configs/
â”‚   â”‚       â””â”€â”€ train_teacher_korean.yaml             # í•™ìŠµ ì„¤ì • (Weighted Sampler/Loss)
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ“ˆ ì‹œê°í™” ê²°ê³¼ (ì¶œë ¥)
â”‚   â”‚   â””â”€â”€ outputs/
â”‚   â”‚       â””â”€â”€ temporal_viz/
â”‚   â”‚           â”œâ”€â”€ test_00000_fake.png               # FAKE ìƒ˜í”Œ (P=99.4%, 604/604 ê³ ìœ„í—˜)
â”‚   â”‚           â”œâ”€â”€ test_00001_fake.png               # FAKE ìƒ˜í”Œ (P=96.1%)
â”‚   â”‚           â”œâ”€â”€ test_00004_fake.png               # FAKE ìƒ˜í”Œ (P=98.2%)
â”‚   â”‚           â”œâ”€â”€ test_00002_real.png               # âš ï¸ REAL ìƒ˜í”Œ (P=77.5%, ì˜¤ë¶„ë¥˜)
â”‚   â”‚           â””â”€â”€ test_00003_real.png               # âš ï¸ REAL ìƒ˜í”Œ (P=73.0%, ì˜¤ë¶„ë¥˜)
â”‚   â”‚
â”‚   â””â”€â”€ ğŸ§ª í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸
â”‚       â””â”€â”€ scripts/
â”‚           â”œâ”€â”€ train.py                              # K-Fold + Weighted ë°©ë²• êµ¬í˜„
â”‚           â”œâ”€â”€ check_cuda.py                         # GPU í™˜ê²½ ê²€ì¦
â”‚           â””â”€â”€ evaluate.py                           # ëª¨ë¸ í‰ê°€
â”‚
â”œâ”€â”€ preprocessed_data_phoneme/                        # ì „ì²˜ë¦¬ëœ ë°ì´í„°
â”‚   â”œâ”€â”€ test/
â”‚   â”‚   â”œâ”€â”€ test_00000.npz                            # FAKE (20ì´ˆ, 604 í”„ë ˆì„)
â”‚   â”‚   â”œâ”€â”€ test_00001.npz                            # FAKE (20ì´ˆ, 601 í”„ë ˆì„)
â”‚   â”‚   â”œâ”€â”€ test_00002.npz                            # REAL (180ì´ˆ, 5396 í”„ë ˆì„)
â”‚   â”‚   â”œâ”€â”€ test_00003.npz                            # REAL (180ì´ˆ, 5396 í”„ë ˆì„)
â”‚   â”‚   â””â”€â”€ test_00004.npz                            # FAKE (20ì´ˆ, 601 í”„ë ˆì„)
â”‚   â”œâ”€â”€ train/                                        # ~734 .npz files
â”‚   â””â”€â”€ val/                                          # ~183 .npz files
â”‚
â”œâ”€â”€ real_deepfake_dataset/                            # ì›ë³¸ ì˜ìƒ (MMSBAdapterê°€ ì°¸ì¡°)
â”‚   â””â”€â”€ 003.ë”¥í˜ì´í¬/
â”‚       â””â”€â”€ 1.Training/
â”‚           â””â”€â”€ ì›ì²œë°ì´í„°/
â”‚               â”œâ”€â”€ 01.ì›ë³¸/                          # REAL ì›ë³¸ ì˜ìƒ
â”‚               â””â”€â”€ 02.ë³€ì¡°/                          # FAKE ë”¥í˜ì´í¬ ì˜ìƒ
â”‚
â””â”€â”€ diary/                                            # ì—°êµ¬ ë³´ê³ ì„œ
    â”œâ”€â”€ 2025-11-16_MMMS-BA_Training_KFold_Temporal_Viz_Research_Report.md
    â””â”€â”€ 2025-11-17_Weighted_Sampler_Loss_FAKE_Bias_Analysis.md
```

---

## ğŸ¯ í•µì‹¬ íŒŒì¼ ì„¤ëª…

### 1ï¸âƒ£ **ì‹œê°í™” ë©”ì¸ ìŠ¤í¬ë¦½íŠ¸**

```
visualize_temporal_prediction.py
â”œâ”€â”€ ê¸°ëŠ¥: ë‹¨ì¼ .npz íŒŒì¼ì˜ í”„ë ˆì„ë³„ Fake í™•ë¥ ì„ ì‹œê°„ì¶•ìœ¼ë¡œ ì‹œê°í™”
â”œâ”€â”€ ì…ë ¥:
â”‚   â”œâ”€â”€ NPZ íŒŒì¼ ê²½ë¡œ (preprocessed_data_phoneme/test/*.npz)
â”‚   â”œâ”€â”€ ëª¨ë¸ ì²´í¬í¬ì¸íŠ¸ (models/kfold/fold_4/mmms-ba_balanced_best.pth)
â”‚   â””â”€â”€ ì„¤ì • íŒŒì¼ (configs/train_teacher_korean.yaml)
â”œâ”€â”€ ì²˜ë¦¬:
â”‚   â”œâ”€â”€ MMSBAdapter.load_npz_with_full_frames() â†’ ì „ì²´ í”„ë ˆì„ ë¡œë“œ
â”‚   â”œâ”€â”€ ê° í”„ë ˆì„ì„ ë…ë¦½ ì‹œí€€ìŠ¤ë¡œ ì²˜ë¦¬ (frame-level prediction)
â”‚   â””â”€â”€ 3-row layout ìƒì„± (ìƒ˜í”Œ í”„ë ˆì„ + ê·¸ë˜í”„ + íˆíŠ¸ë§µ)
â””â”€â”€ ì¶œë ¥: PNG íŒŒì¼ (1920x1080)
    â”œâ”€â”€ Row 1: 6ê°œ ëŒ€í‘œ í”„ë ˆì„
    â”œâ”€â”€ Row 2: ì‹œê°„(ì´ˆ) vs P(Fake) ê·¸ë˜í”„
    â””â”€â”€ Row 3: ìƒ‰ìƒ íˆíŠ¸ë§µ (ë…¹ìƒ‰â†’ë…¸ë€ìƒ‰â†’ë¹¨ê°„ìƒ‰)
```

```
batch_visualize_temporal.py
â”œâ”€â”€ ê¸°ëŠ¥: ì—¬ëŸ¬ í…ŒìŠ¤íŠ¸ ìƒ˜í”Œì„ ìë™ìœ¼ë¡œ ë°°ì¹˜ ì‹œê°í™”
â”œâ”€â”€ ì„¤ì •:
â”‚   â”œâ”€â”€ Line 19: model_path = "models/kfold/fold_4/mmms-ba_balanced_best.pth"
â”‚   â””â”€â”€ Line 23-27: test_samples ë¦¬ìŠ¤íŠ¸ (5ê°œ)
â”œâ”€â”€ ë£¨í”„: visualize_temporal_prediction() ë°˜ë³µ í˜¸ì¶œ
â””â”€â”€ ì¶œë ¥: outputs/temporal_viz/*.png (5ê°œ íŒŒì¼)
```

### 2ï¸âƒ£ **ëª¨ë¸ ë° ì²´í¬í¬ì¸íŠ¸**

```
models/kfold/
â”œâ”€â”€ fold_1/mmms-ba_best.pth                   # Baseline ëª¨ë¸
â”‚   â”œâ”€â”€ Validation Accuracy: 94.57%
â”‚   â”œâ”€â”€ Best Epoch: 13
â”‚   â””â”€â”€ REAL P(Fake): 58% (ìƒëŒ€ì ìœ¼ë¡œ ë‚˜ìŒ)
â”‚
â”œâ”€â”€ fold_4/mmms-ba_balanced_best.pth          # â­ Weighted ìµœê³  ì„±ëŠ¥ ëª¨ë¸
â”‚   â”œâ”€â”€ Validation Accuracy: 99.45%
â”‚   â”œâ”€â”€ Best Epoch: 7
â”‚   â”œâ”€â”€ Precision: 99.17%, Recall: 100%, F1: 99.59%
â”‚   â””â”€â”€ REAL P(Fake): 73-77% âš ï¸ (ì•…í™”ë¨)
â”‚
â””â”€â”€ kfold_results.json
    â”œâ”€â”€ mean_val_acc: 0.9760 Â± 0.0167
    â”œâ”€â”€ mean_val_f1: 0.9820 Â± 0.0124
    â””â”€â”€ foldë³„ ìƒì„¸ ë©”íŠ¸ë¦­
```

```
src/models/teacher.py
â””â”€â”€ class MMMSBA(nn.Module)
    â”œâ”€â”€ __init__()
    â”‚   â”œâ”€â”€ audio_dim=40 (MFCC)
    â”‚   â”œâ”€â”€ visual_dim=256 (ResNet, í•˜ë“œì½”ë”©)
    â”‚   â”œâ”€â”€ lip_dim=128 (Lip ROI, í•˜ë“œì½”ë”©)
    â”‚   â”œâ”€â”€ gru_hidden_dim=300
    â”‚   â”œâ”€â”€ dense_hidden_dim=100
    â”‚   â””â”€â”€ attention_type="bi_modal"
    â”‚
    â””â”€â”€ forward(audio, frames, lip, frame_level=False)
        â”œâ”€â”€ frame_level=False: Video-level ì˜ˆì¸¡ (1ê°œ ì¶œë ¥)
        â””â”€â”€ frame_level=True: Frame-level ì˜ˆì¸¡ (Tê°œ ì¶œë ¥) â† ì‹œê°í™”ìš©
```

### 3ï¸âƒ£ **ìœ í‹¸ë¦¬í‹° - Full Frame ë¡œë”**

```
src/utils/mmms_ba_adapter.py
â””â”€â”€ class MMSBAdapter
    â””â”€â”€ load_npz_with_full_frames(npz_path, extract_lip=True)
        â”œâ”€â”€ ì…ë ¥: preprocessed_data_phoneme/test/test_00002.npz
        â”œâ”€â”€ ì²˜ë¦¬:
        â”‚   â”œâ”€â”€ 1. NPZì—ì„œ metadata ì½ê¸° (original_video_path, video_id)
        â”‚   â”œâ”€â”€ 2. ì›ë³¸ ì˜ìƒ ë¡œë“œ (real_deepfake_dataset/.../ì›ì²œë°ì´í„°/)
        â”‚   â”œâ”€â”€ 3. OpenCVë¡œ ì „ì²´ í”„ë ˆì„ ì¶”ì¶œ (5396 frames for 180s)
        â”‚   â”œâ”€â”€ 4. Timestamp ê¸°ë°˜ audio/lip ë™ê¸°í™”
        â”‚   â””â”€â”€ 5. í”„ë ˆì„ë³„ ì „ì²˜ë¦¬ (resize, normalize)
        â””â”€â”€ ì¶œë ¥:
            â”œâ”€â”€ frames: (5396, 224, 224, 3)      # ì „ì²´ í”„ë ˆì„
            â”œâ”€â”€ audio: (T_audio, 40)              # MFCC
            â”œâ”€â”€ lip: (5396, 112, 112, 3)          # ì „ì²´ Lip ROI
            â”œâ”€â”€ timestamps: (5396,)               # [0.0, 0.033, ..., 179.97]
            â”œâ”€â”€ total_frames: 5396
            â””â”€â”€ video_fps: 30.0
```

### 4ï¸âƒ£ **ì„¤ì • íŒŒì¼**

```
configs/train_teacher_korean.yaml
â”œâ”€â”€ model:
â”‚   â”œâ”€â”€ gru.hidden_size: 300
â”‚   â”œâ”€â”€ dense.hidden_size: 100
â”‚   â””â”€â”€ attention.type: "bi_modal"
â”‚
â”œâ”€â”€ training:
â”‚   â”œâ”€â”€ use_weighted_sampler: true            # REAL ì˜¤ë²„ìƒ˜í”Œë§
â”‚   â”œâ”€â”€ use_weighted_loss: true               # REAL ê°€ì¤‘ì¹˜ 2.0x
â”‚   â”œâ”€â”€ class_weights: [2.0, 1.0]             # [Real, Fake]
â”‚   â”œâ”€â”€ epochs: 15
â”‚   â”œâ”€â”€ batch_size: 8
â”‚   â”œâ”€â”€ optimizer:
â”‚   â”‚   â”œâ”€â”€ type: adam
â”‚   â”‚   â”œâ”€â”€ lr: 0.0005
â”‚   â”‚   â””â”€â”€ weight_decay: 0.0001
â”‚   â””â”€â”€ early_stopping:
â”‚       â”œâ”€â”€ patience: 5
â”‚       â””â”€â”€ monitor: val_loss
â”‚
â””â”€â”€ dataset:
    â”œâ”€â”€ root_dir: "E:/capstone/preprocessed_data_phoneme"
    â””â”€â”€ audio.n_mfcc: 40
```

### 5ï¸âƒ£ **í•™ìŠµ ìŠ¤í¬ë¦½íŠ¸**

```
scripts/train.py
â”œâ”€â”€ Command-line ì¸í„°í˜ì´ìŠ¤:
â”‚   â”œâ”€â”€ --kfold 5                             # 5-Fold Cross Validation
â”‚   â”œâ”€â”€ --use-weighted-sampler                # Weighted Sampler í™œì„±í™”
â”‚   â”œâ”€â”€ --use-weighted-loss                   # Weighted Loss í™œì„±í™”
â”‚   â””â”€â”€ --class-weights 2.0 1.0               # REAL=2.0x, FAKE=1.0x
â”‚
â”œâ”€â”€ Weighted Random Sampler êµ¬í˜„ (Line 624-633):
â”‚   â””â”€â”€ WeightedRandomSampler(
â”‚           weights=[0.00316 for REAL, 0.00167 for FAKE],
â”‚           num_samples=len(train_data),
â”‚           replacement=True  # ì¤‘ë³µ í—ˆìš©
â”‚       )
â”‚
â”œâ”€â”€ Weighted Cross Entropy Loss êµ¬í˜„ (Line 86-100):
â”‚   â””â”€â”€ nn.CrossEntropyLoss(
â”‚           weight=torch.tensor([2.0, 1.0]),  # REAL ì˜¤ë¶„ë¥˜ ì‹œ loss 2ë°°
â”‚           label_smoothing=0.1
â”‚       )
â”‚
â””â”€â”€ Checkpoint ì´ë¦„ ìë™ ë³€ê²½ (Line 567-570):
    â”œâ”€â”€ Baseline: mmms-ba_best.pth
    â””â”€â”€ Weighted: mmms-ba_balanced_best.pth
```

---

## ğŸ“Š ì‹œê°í™” ê²°ê³¼ íŒŒì¼ ìƒì„¸

```
outputs/temporal_viz/
â”œâ”€â”€ test_00000_fake.png                       # FAKE ìƒ˜í”Œ 1
â”‚   â”œâ”€â”€ ì´ í”„ë ˆì„: 604 (20.12ì´ˆ @ 30 FPS)
â”‚   â”œâ”€â”€ í‰ê·  P(Fake): 99.4%
â”‚   â”œâ”€â”€ ê³ ìœ„í—˜ í”„ë ˆì„: 604/604 (100.0%)
â”‚   â””â”€â”€ ì¢…í•© íŒì •: FAKE âœ“
â”‚
â”œâ”€â”€ test_00001_fake.png                       # FAKE ìƒ˜í”Œ 2
â”‚   â”œâ”€â”€ ì´ í”„ë ˆì„: 601 (20.02ì´ˆ)
â”‚   â”œâ”€â”€ í‰ê·  P(Fake): 96.1%
â”‚   â””â”€â”€ ì¢…í•© íŒì •: FAKE âœ“
â”‚
â”œâ”€â”€ test_00004_fake.png                       # FAKE ìƒ˜í”Œ 3
â”‚   â”œâ”€â”€ ì´ í”„ë ˆì„: 601 (20.02ì´ˆ)
â”‚   â”œâ”€â”€ í‰ê·  P(Fake): 98.2%
â”‚   â””â”€â”€ ì¢…í•© íŒì •: FAKE âœ“
â”‚
â”œâ”€â”€ test_00002_real.png                       # âš ï¸ REAL ìƒ˜í”Œ 1 (ì˜¤ë¶„ë¥˜)
â”‚   â”œâ”€â”€ ì´ í”„ë ˆì„: 5396 (180.01ì´ˆ @ 30 FPS)
â”‚   â”œâ”€â”€ í‰ê·  P(Fake): 77.5% (ì´ì „: 58.3%)
â”‚   â”œâ”€â”€ ê³ ìœ„í—˜ í”„ë ˆì„: 5396/5396 (100.0%)
â”‚   â”œâ”€â”€ ì‹œê°„ì  íŒ¨í„´:
â”‚   â”‚   â”œâ”€â”€ 0-90ì´ˆ: P(Fake) = 70-80%
â”‚   â”‚   â””â”€â”€ 90-180ì´ˆ: P(Fake) = 75-85%
â”‚   â””â”€â”€ ì¢…í•© íŒì •: FAKE âœ— (ì˜¤ë¶„ë¥˜)
â”‚
â””â”€â”€ test_00003_real.png                       # âš ï¸ REAL ìƒ˜í”Œ 2 (ì˜¤ë¶„ë¥˜)
    â”œâ”€â”€ ì´ í”„ë ˆì„: 5396 (180.01ì´ˆ)
    â”œâ”€â”€ í‰ê·  P(Fake): 73.0% (ì´ì „: 58.8%)
    â”œâ”€â”€ ê³ ìœ„í—˜ í”„ë ˆì„: 5383/5396 (99.8%)
    â””â”€â”€ ì¢…í•© íŒì •: FAKE âœ— (ì˜¤ë¶„ë¥˜)
```

---

## ğŸ”„ ì‹œê°í™” íŒŒì´í”„ë¼ì¸ íë¦„ë„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. ì…ë ¥ ì¤€ë¹„                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”œâ”€â”€ NPZ íŒŒì¼: preprocessed_data_phoneme/test/test_00002.npzâ”‚
â”‚  â”œâ”€â”€ ëª¨ë¸: models/kfold/fold_4/mmms-ba_balanced_best.pth    â”‚
â”‚  â””â”€â”€ ì„¤ì •: configs/train_teacher_korean.yaml                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. Full Frame ë¡œë“œ (MMSBAdapter)                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”œâ”€â”€ NPZ metadata ì½ê¸° â†’ original_video_path ì¶”ì¶œ            â”‚
â”‚  â”œâ”€â”€ ì›ë³¸ ì˜ìƒ ë¡œë“œ (real_deepfake_dataset/)                 â”‚
â”‚  â”œâ”€â”€ OpenCVë¡œ ì „ì²´ í”„ë ˆì„ ì¶”ì¶œ (5396 frames)                 â”‚
â”‚  â””â”€â”€ ì¶œë ¥: frames (5396, 224, 224, 3), timestamps (5396,)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Frame-level Prediction (ê° í”„ë ˆì„ ë…ë¦½ ì²˜ë¦¬)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  for i in range(5396):                                      â”‚
â”‚      frame_batch = frames[i:i+1]  # (1, 1, 224, 224, 3)     â”‚
â”‚      logits = model(audio, frame_batch, lip)  # (1, 2)      â”‚
â”‚      prob_fake = softmax(logits)[0, 1]        # Scalar      â”‚
â”‚      frame_predictions.append(prob_fake)                    â”‚
â”‚  â†’ ì¶œë ¥: frame_predictions (5396,)                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. 3-Row Layout ì‹œê°í™” ìƒì„±                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Row 1: ëŒ€í‘œ í”„ë ˆì„ 6ê°œ                                 â”‚ â”‚
â”‚  â”‚ [0ì´ˆ] [ì¤‘ê°„] [ë§ˆì§€ë§‰] + [ê³ ìœ„í—˜ 3ê°œ]                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Row 2: ì‹œê°„(ì´ˆ) vs P(Fake) ê·¸ë˜í”„                      â”‚ â”‚
â”‚  â”‚  1.0â”¤                 â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®         â”‚ â”‚
â”‚  â”‚  0.8â”¤              â•­â”€â”€â•¯                     â•°â”€â”€â•®      â”‚ â”‚
â”‚  â”‚  0.6â”¤ â”€ â”€ â”€ â”€ â”€ â”€ â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€ Thresâ”‚ â”‚
â”‚  â”‚  0.4â”¤              â”‚                         â”‚         â”‚ â”‚
â”‚  â”‚  0.2â”¤              â”‚                         â”‚         â”‚ â”‚
â”‚  â”‚  0.0â”¤â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â–º    â”‚ â”‚
â”‚  â”‚      0s           60s                     180s         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Row 3: ìƒ‰ìƒ íˆíŠ¸ë§µ (Risk Level)                        â”‚ â”‚
â”‚  â”‚  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ (ë¹¨ê°„ìƒ‰ = ê³ ìœ„í—˜)   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. ì €ì¥                                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  outputs/temporal_viz/test_00002_real.png (1920x1080)      â”‚
â”‚  â”œâ”€â”€ í‰ê·  P(Fake): 77.5%                                    â”‚
â”‚  â”œâ”€â”€ ê³ ìœ„í—˜ í”„ë ˆì„: 5396/5396 (100%)                        â”‚
â”‚  â””â”€â”€ ì¢…í•© íŒì •: FAKE (ì˜¤ë¶„ë¥˜)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš¨ ì£¼ì˜ì‚¬í•­

### âš ï¸ Weighted ëª¨ë¸ ì‚¬ìš© ì‹œ ë¬¸ì œì 

```
Fold 4 ëª¨ë¸ (mmms-ba_balanced_best.pth) ì‚¬ìš© ì‹œ:
â”œâ”€â”€ ê²€ì¦ ë©”íŠ¸ë¦­: âœ… Val Acc 99.45% (ìš°ìˆ˜)
â””â”€â”€ í”„ë ˆì„ ë ˆë²¨: âŒ REAL P(Fake) 73-77% (ì•…í™”)
    â””â”€â”€ ì›ì¸: Weighted Sampler/Lossê°€ FAKE í¸í–¥ ê°•í™”

ê¶Œì¥ ì‚¬í•­:
â”œâ”€â”€ Hybrid íŒŒì´í”„ë¼ì¸ì—ì„œëŠ” Baseline ëª¨ë¸(Fold 1) ì‚¬ìš©
â”‚   â””â”€â”€ mmms-ba_best.pth (Val Acc: 94.57%, REAL P(Fake): 58%)
â”‚
â”œâ”€â”€ ë˜ëŠ” Threshold ì¡°ì •
â”‚   â”œâ”€â”€ ê¸°ì¡´: 0.5
â”‚   â””â”€â”€ ìˆ˜ì •: 0.65-0.70 (REAL í¸í–¥ ì™„í™”)
â”‚
â””â”€â”€ í–¥í›„: Focal Loss ê¸°ë°˜ ëª¨ë¸ë¡œ êµì²´
    â””â”€â”€ Future Work ì°¸ì¡°
```

---

**ìƒì„±ì¼**: 2025-11-17
**ë¬¸ì„œ ë²„ì „**: 1.0
**ê´€ë ¨ ë³´ê³ ì„œ**:
- `diary/2025-11-16_MMMS-BA_Training_KFold_Temporal_Viz_Research_Report.md`
- `diary/2025-11-17_Weighted_Sampler_Loss_FAKE_Bias_Analysis.md`